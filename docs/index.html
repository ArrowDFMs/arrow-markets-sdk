<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@arrow-markets/arrow-sdk</title><meta name="description" content="Documentation for @arrow-markets/arrow-sdk"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@arrow-markets/arrow-sdk</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>@arrow-markets/arrow-sdk</h2></div>
<div class="tsd-panel tsd-typography">
<a href="#arrow-api" id="arrow-api" style="color: inherit; text-decoration: none;">
  <h1>Arrow API</h1>
</a>
<p>Arrow Markets has an API for interacting with its contract suite. This is due to the fact that we compute an option&#39;s price off-chain and therefore must pass it securely as a part of the transaction parameters. The transaction must be submitted by the deployer of the contracts.</p>
<p>There is an <code>arrow-sdk.ts</code> file in the repository that contains useful variables, objects, and functions, such as the API URL and the router contract. For reference, the scripts contained within the <code>./examples</code> folder make use of that file.</p>

<a href="#api-urls" id="api-urls" style="color: inherit; text-decoration: none;">
  <h2>API URLs</h2>
</a>
<p>The API can be accessed via <code>https://fuji-v3-api.arrow.markets/v1/&lt;ENDPOINT&gt;</code> or <code>https://competition-v2-api.arrow.markets/v1/&lt;ENDPOINT&gt;</code><br>The Fuji test network can be accessed via <code>https://api.avax-test.network/ext/bc/C/rpc</code></p>

<a href="#endpoints" id="endpoints" style="color: inherit; text-decoration: none;">
  <h2>Endpoints</h2>
</a>
<p>Estimate Option Price: <code>/estimate-option-price</code><br><code>POST</code> request<br><br>Inputs:</p>
<pre><code><span class="hl-0">Body</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;order_type&quot;</span><span class="hl-1">, </span><span class="hl-3">// 0 for open long, 1 for close long, 2 for open short, and 3 for close short.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;ticker&quot;</span><span class="hl-1">, </span><span class="hl-3">// String to indicate a particular asset (&quot;AVAX&quot;, &quot;ETH&quot;, &quot;BTC&quot;, or &quot;LINK&quot;).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;expiration&quot;</span><span class="hl-1">, </span><span class="hl-3">// Date in &quot;MMDDYYYY&quot; format (e.g. &quot;01252022&quot; for January 25th, 2022).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;strike&quot;</span><span class="hl-1">, </span><span class="hl-3">// Price at which contract becomes active at expiration.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;contract_type&quot;</span><span class="hl-1">, </span><span class="hl-3">// 0 for call, 1 for put, 2 for call spread, and 3 for put spread.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;quantity&quot;</span><span class="hl-1">, </span><span class="hl-3">// Number of contracts desired in the order.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;spot_price&quot;</span><span class="hl-1">, </span><span class="hl-3">// Current price of underlying assetas number. We recommend requesting this data from https://api.binance.com/api/v3/ticker/price?symbol={binance_symbol}.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;price_history&quot;</span><span class="hl-1"> </span><span class="hl-3">// Price history of underlying asset in an array. We recommend requesting this data from https://api.coingecko.com/api/v3/coins/{crypto_id}/market_chart?vs_currency=usd&amp;days=84.</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Outputs:</p>
<pre><code><span class="hl-1">{</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;option_price&quot;</span><span class="hl-1">, </span><span class="hl-3">// Current price of the option contract given the data from the &quot;price_history&quot; input.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;greeks&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;delta&quot;</span><span class="hl-1">, </span><span class="hl-3">// Sensitivity of an option’s price to changes in the value of the underlying.</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;gamma&quot;</span><span class="hl-1">, </span><span class="hl-3">// Change in delta per change in price of the underlying.</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;theta&quot;</span><span class="hl-1">, </span><span class="hl-3">// Measures time decay of price of option.</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;rho&quot;</span><span class="hl-1">, </span><span class="hl-3">// Sensitivity of option prices to changes in interest rates.</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;vega&quot;</span><span class="hl-4"> </span><span class="hl-3">// Change in value from a 1% change in volatility.</span><br/><span class="hl-4">    }</span><br/><span class="hl-4">}</span>
</code></pre>
<p><br>Get Recommended Option: <code>/get-recommended-option</code><br>Note: This currently only works with the speculation workflow. Hedging workflow is coming soon.<br><code>GET</code> request<br><br>Inputs:</p>
<pre><code><span class="hl-0">Params</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;ticker&quot;</span><span class="hl-1">, </span><span class="hl-3">// String to indicate a particular asset (&quot;AVAX&quot;, &quot;ETH&quot;, or &quot;BTC&quot;).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;expiration&quot;</span><span class="hl-1">, </span><span class="hl-3">// Date in &quot;MMDDYYYY&quot; format (e.g. &quot;01252022&quot; for January 25th, 2022).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;forecast&quot;</span><span class="hl-1"> </span><span class="hl-3">// Forecasted price of the underlying asset (e.g. we might expect AVAX to reach $115, so we would pass 115).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;spot_price&quot;</span><span class="hl-1"> </span><span class="hl-3">// Current price of underlying assetas number.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;price_history&quot;</span><span class="hl-1"> </span><span class="hl-3">// Price history of underlying asset in an array.</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Outputs:</p>
<pre><code><span class="hl-1">{</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;option&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;strike&quot;</span><span class="hl-4"> </span><span class="hl-3">// Price at which contract becomes active at expiration.</span><br/><span class="hl-4">        </span><span class="hl-2">&quot;price&quot;</span><span class="hl-1">, </span><span class="hl-3">// Current price of the option contract.</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;contract_type&quot;</span><span class="hl-1">, </span><span class="hl-3">// 0 for call, 1 for put, 2 for call spread, and 3 for put spread. </span><br/><span class="hl-1">        </span><span class="hl-2">&quot;greeks&quot;</span><span class="hl-4">:</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;delta&quot;</span><span class="hl-1">, </span><span class="hl-3">// Sensitivity of an option’s price to changes in the value of the underlying.</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;gamma&quot;</span><span class="hl-1">, </span><span class="hl-3">// Change in delta per change in price of the underlying.</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;theta&quot;</span><span class="hl-1">, </span><span class="hl-3">// Measures time decay of price of option.</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;rho&quot;</span><span class="hl-1">, </span><span class="hl-3">// Sensitivity of option prices to changes in interest rates.</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;vega&quot;</span><span class="hl-4"> </span><span class="hl-3">// Change in value from a 1% change in volatility.</span><br/><span class="hl-4">        },</span><br/><span class="hl-4">    }</span><br/><span class="hl-4">}</span>
</code></pre>
<p><br>Submit Order: <code>/submit-order</code><br><code>POST</code> request</p>
<pre><code><span class="hl-0">Body</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;order_type&quot;</span><span class="hl-1">, </span><span class="hl-3">// 0 for open long, 1 for close long, 2 for open short, and 3 for close short.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;ticker&quot;</span><span class="hl-1">, </span><span class="hl-3">// String to indicate a particular asset (&quot;AVAX&quot;, &quot;ETH&quot;, or &quot;BTC&quot;).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;expiration&quot;</span><span class="hl-1">, </span><span class="hl-3">// Date in &quot;MMDDYYYY&quot; format (e.g. &quot;01252022&quot; for January 25th, 2022).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;strike&quot;</span><span class="hl-1">, </span><span class="hl-3">// Price at which contract becomes active at expiration.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;contract_type&quot;</span><span class="hl-1">, </span><span class="hl-3">// 0 for call, 1 for put, 2 for call spread, and 3 for put spread.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;quantity&quot;</span><span class="hl-1">, </span><span class="hl-3">// Number of contracts desired in the order.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;threshold_price&quot;</span><span class="hl-1">, </span><span class="hl-3">// Indication of the price the user is willing to pay (e.g. ethers.utils.parseUnits(priceWillingToPay, await usdc_e.decimals()).toString()).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;hashed_params&quot;</span><span class="hl-1">, </span><span class="hl-3">// Stringified hash of parameters.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;signature&quot;</span><span class="hl-1"> </span><span class="hl-3">// User&#39;s signature of the hashed parameters.</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Note: For ease of use, we may update the <code>threshold_price</code> parameter to ask for a javascript number instead of a parsed ethers BigNumber.<br><br>Outputs:</p>
<pre><code><span class="hl-1">{</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;tx_hash&quot;</span><span class="hl-1">, </span><span class="hl-3">// Hash of the transaction that was submitted upon successful API request.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;execution_price&quot;</span><span class="hl-1"> </span><span class="hl-3">// Price that the user was charged per option contract in the order.</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#arrow-contracts" id="arrow-contracts" style="color: inherit; text-decoration: none;">
  <h1>Arrow Contracts</h1>
</a>
<p>There are several smart contracts that comprise the Arrow Markets smart contract suite, however, due to the architecture of the deployment, only a few are necessary for developing composable products and features.</p>
<p>The important contracts are the ArrowRouter, ArrowRegistry, and ArrowEvents contracts.</p>

<a href="#arrow-event-specifications" id="arrow-event-specifications" style="color: inherit; text-decoration: none;">
  <h2>Arrow Event Specifications</h2>
</a>
<p>Developers may find it useful to access logs from the Arrow Events contract. Standard events filters from <code>web3.py</code>, <code>web3.js</code> and <code>ethers.js</code> can be used.</p>
<p>The most relevant events are likely the <code>NewLiabilityCreation</code> and <code>NewLiabilityDestruction</code> events. The rest of the events can be found in the <code>IArrowEvents.json</code> ABI files.</p>
<p>The NewLiabilityCreation and NewLiabilityDestruction events look as follows:</p>
<pre><code><span class="hl-1">{</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;ownerAddress&quot;</span><span class="hl-1">: </span><span class="hl-4">address</span><span class="hl-1">, </span><span class="hl-3">// Indexed address of the owner of the new liability</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;optionAddress&quot;</span><span class="hl-1">: </span><span class="hl-4">address</span><span class="hl-1">, </span><span class="hl-3">// Indexed address of the on-chain option contract</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;hashedTicker&quot;</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-3">// Indexed string to indicate a particular asset (&quot;AVAX&quot;, &quot;ETH&quot;, &quot;BTC&quot;, or &quot;LINK&quot;).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;ticker&quot;</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1"> </span><span class="hl-3">// String to indicate a particular asset (&quot;AVAX&quot;, &quot;ETH&quot;, &quot;BTC&quot;, or &quot;LINK&quot;).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;expiration&quot;</span><span class="hl-1">: </span><span class="hl-4">uint256</span><span class="hl-1">, </span><span class="hl-3">// Date in Unix timestamp. Must be 9:00 PM UTC (e.g. 1643144400 for January 25th, 2022)</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;readableExpiration&quot;</span><span class="hl-1">: </span><span class="hl-4">uint256</span><span class="hl-1">, </span><span class="hl-3">// Date in &quot;MMDDYYYY&quot; format (e.g. &quot;01252022&quot; for January 25th, 2022).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;decimalStrike&quot;</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-3">// String version of the strike that includes the decimal places (e.g. &quot;12.25&quot;).</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;contractType&quot;</span><span class="hl-1">: </span><span class="hl-4">uint256</span><span class="hl-1">, </span><span class="hl-3">// 0 for call, 1 for put, 2 for call spread, and 3 for put spread.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;quantity&quot;</span><span class="hl-1">: </span><span class="hl-4">uint256</span><span class="hl-1">, </span><span class="hl-3">// Number of contracts desired in the order.</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;optionPrice&quot;</span><span class="hl-1">: </span><span class="hl-4">uint256</span><span class="hl-1"> </span><span class="hl-3">// Price paid or received for each of the option contracts.</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#examples" id="examples" style="color: inherit; text-decoration: none;">
  <h1>Examples</h1>
</a>

<a href="#getting-stablecoin-contract-from-router-contract" id="getting-stablecoin-contract-from-router-contract" style="color: inherit; text-decoration: none;">
  <h2>Getting Stablecoin Contract From Router Contract</h2>
</a>
<p>The code below is an example of how to access contract addresses through the Arrow router contract. The code is available in <code>./examples/get-stablecoin-contract.ts</code> as well.</p>
<pre><code class="language-javascript"><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-4">arrowsdk</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;../lib/src/arrow-sdk&quot;</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-7">main</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-8">version</span><span class="hl-1"> = </span><span class="hl-4">arrowsdk</span><span class="hl-1">.</span><span class="hl-4">Version</span><span class="hl-1">.</span><span class="hl-8">V3</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-8">stablecoin</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-4">arrowsdk</span><span class="hl-1">.</span><span class="hl-7">getStablecoinContract</span><span class="hl-1">(</span><span class="hl-4">version</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><span class="hl-7">main</span><span class="hl-1">()</span>
</code></pre>

<a href="#submitting-option-order-through-api" id="submitting-option-order-through-api" style="color: inherit; text-decoration: none;">
  <h2>Submitting Option Order Through API</h2>
</a>
<p>The code below is used to place an order on the Arrow platform. There are several steps outlined for this. For the full script, please refer to <code>./examples/place-option-order.ts</code><br><br>Step 1: Prepare the <code>deliverOption()</code> function call parameters. This includes hashing the option parameters and having the user sign the hash.</p>
<pre><code class="language-javascript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-8">deliverOptionParams</span><span class="hl-1">: </span><span class="hl-9">DeliverOptionParams</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-4">arrowsdk</span><span class="hl-1">.</span><span class="hl-7">prepareDeliverOptionParams</span><span class="hl-1">(</span><span class="hl-4">optionOrderParams</span><span class="hl-1">, </span><span class="hl-4">version</span><span class="hl-1">, </span><span class="hl-4">wallet</span><span class="hl-1">)</span>
</code></pre>
<p>Inside <code>prepareDeliverOptionParams()</code> we can see how the hash and signature are produced</p>
<pre><code class="language-javascript"><span class="hl-3">// Hash and sign the option order parameters for on-chain verification</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-8">hashedValues</span><span class="hl-1"> = </span><span class="hl-4">ethers</span><span class="hl-1">.</span><span class="hl-4">utils</span><span class="hl-1">.</span><span class="hl-7">solidityKeccak256</span><span class="hl-1">(</span><br/><span class="hl-1">    [</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;bool&quot;</span><span class="hl-1">,       </span><span class="hl-3">// buyFlag - Boolean to indicate whether this is a buy (true) or sell (false).</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;string&quot;</span><span class="hl-1">,     </span><span class="hl-3">// ticker - String to indicate a particular asset (&quot;AVAX&quot;, &quot;ETH&quot;, or &quot;BTC&quot;).</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;uint256&quot;</span><span class="hl-1">,    </span><span class="hl-3">// expiration - Date in Unix timestamp. Must be 8:00 AM UTC (e.g. 1643097600 for January 25th, 2022).</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;uint256&quot;</span><span class="hl-1">,    </span><span class="hl-3">// readableExpiration - Date in &quot;MMDDYYYY&quot; format (e.g. &quot;01252022&quot; for January 25th, 2022).</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;uint256[2]&quot;</span><span class="hl-1">, </span><span class="hl-3">// strike - Ethers BigNumber versions of the strikes in terms of the stablecoin&#39;s decimals (e.g. [ethers.utils.parseUnits(strike, await usdc_e.decimals()), ethers.BigNumber.from(0)]).</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;string&quot;</span><span class="hl-1">,     </span><span class="hl-3">// decimalStrike - String version of the strike that includes the decimal places (e.g. &quot;12.25&quot;).</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;uint256&quot;</span><span class="hl-1">,    </span><span class="hl-3">// contractType - 0 for call, 1 for put, 2 for call spread, and 3 for put spread.</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;uint256&quot;</span><span class="hl-1">,    </span><span class="hl-3">// quantity - Integer number of contracts desired in the order. Has to be scaled by supported decimals (10**2).</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;uint256&quot;</span><span class="hl-1">     </span><span class="hl-3">// thresholdPrice - Indication of the price the user is willing to pay (e.g. ethers.utils.parseUnits(priceWillingToPay, await usdc_e.decimals()).toString()).</span><br/><span class="hl-1">    ],</span><br/><span class="hl-1">    [</span><br/><span class="hl-1">        </span><span class="hl-4">optionOrderParams</span><span class="hl-1">.</span><span class="hl-4">orderType</span><span class="hl-1"> === </span><span class="hl-4">OrderType</span><span class="hl-1">.</span><span class="hl-8">LONG_OPEN</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">optionOrderParams</span><span class="hl-1">.</span><span class="hl-4">ticker</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">unixExpiration</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">optionOrderParams</span><span class="hl-1">.</span><span class="hl-4">expiration</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">bigNumberStrike</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">formattedStrike</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">optionOrderParams</span><span class="hl-1">.</span><span class="hl-4">contractType</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">intQuantity</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">thresholdPrice</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-8">signature</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-4">wallet</span><span class="hl-1">.</span><span class="hl-7">signMessage</span><span class="hl-1">(</span><span class="hl-4">ethers</span><span class="hl-1">.</span><span class="hl-4">utils</span><span class="hl-1">.</span><span class="hl-7">arrayify</span><span class="hl-1">(</span><span class="hl-4">hashedValues</span><span class="hl-1">)) </span><span class="hl-3">// Note that we are signing a message, not a transaction</span>
</code></pre>
<p>Step 2: Approval to option chain proxy.</p>
<p>Because we deal in ERC20s, we require a user to allow the option chain contract to spend their stablecoin with an <code>approve()</code> function call. This must be done before submitting the request to the API to ensure that the transaction will succeed. Since the option chain proxy may not have been deployed yet, we must use <code>CREATE2</code> to compute the address for the option chain contract as follows:</p>
<pre><code class="language-javascript"><span class="hl-3">// Get computed option chain address</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-8">optionChainAddress</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-4">arrowsdk</span><span class="hl-1">.</span><span class="hl-7">computeOptionChainAddress</span><span class="hl-1">(</span><span class="hl-4">option</span><span class="hl-1">.</span><span class="hl-4">ticker</span><span class="hl-1">, </span><span class="hl-4">option</span><span class="hl-1">.</span><span class="hl-4">expiration</span><span class="hl-1">, </span><span class="hl-4">version</span><span class="hl-1">)</span><br/><br/><span class="hl-3">// Approval circuit if the order is a &quot;buy&quot; order</span><br/><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-4">deliverOptionParams</span><span class="hl-1">.</span><span class="hl-4">orderType</span><span class="hl-1"> === </span><span class="hl-4">OrderType</span><span class="hl-1">.</span><span class="hl-8">LONG_OPEN</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">// Get user&#39;s balance of stablecoin</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-8">userBalance</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-4">stablecoin</span><span class="hl-1">.</span><span class="hl-7">balanceOf</span><span class="hl-1">(</span><span class="hl-4">wallet</span><span class="hl-1">.</span><span class="hl-4">address</span><span class="hl-1">)</span><br/><br/><span class="hl-1">    </span><span class="hl-3">// If user&#39;s balance is less than the amount required for the approval, throw an error</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-4">userBalance</span><span class="hl-1">.</span><span class="hl-7">lt</span><span class="hl-1">(</span><span class="hl-4">deliverOptionParams</span><span class="hl-1">.</span><span class="hl-4">amountToApprove</span><span class="hl-1">)) {</span><br/><span class="hl-1">        </span><span class="hl-5">throw</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-7">Error</span><span class="hl-1">(</span><span class="hl-2">&#39;You do not have enough stablecoin to pay for your indicated threshold price.&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">// Get the amount that the option chain proxy is currently approved to spend</span><br/><span class="hl-1">    </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-4">approvedAmount</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-4">stablecoin</span><span class="hl-1">.</span><span class="hl-7">allowance</span><span class="hl-1">(</span><span class="hl-4">wallet</span><span class="hl-1">.</span><span class="hl-4">address</span><span class="hl-1">, </span><span class="hl-4">optionChainAddress</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">// If the approved amount is less than the amount required to be approved, ask user to approve the proper amount</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-4">approvedAmount</span><span class="hl-1">.</span><span class="hl-7">lt</span><span class="hl-1">(</span><span class="hl-4">deliverOptionParams</span><span class="hl-1">.</span><span class="hl-4">amountToApprove</span><span class="hl-1">)) {</span><br/><span class="hl-1">        </span><span class="hl-3">// Wait for the approval to be confirmed on-chain</span><br/><span class="hl-1">        </span><span class="hl-5">await</span><span class="hl-1"> (</span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-4">stablecoin</span><span class="hl-1">.</span><span class="hl-7">approve</span><span class="hl-1">(</span><span class="hl-4">optionChainAddress</span><span class="hl-1">, </span><span class="hl-4">deliverOptionParams</span><span class="hl-1">.</span><span class="hl-4">amountToApprove</span><span class="hl-1">)).</span><span class="hl-7">wait</span><span class="hl-1">(</span><span class="hl-4">numBlockConfirmations</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-3">// Get the amount that the option chain proxy is approved to spend now</span><br/><span class="hl-1">        </span><span class="hl-4">approvedAmount</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-4">stablecoin</span><span class="hl-1">.</span><span class="hl-7">allowance</span><span class="hl-1">(</span><span class="hl-4">wallet</span><span class="hl-1">.</span><span class="hl-4">address</span><span class="hl-1">, </span><span class="hl-4">optionChainAddress</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-3">// If the newly approved amount is still less than the amount required to be approved, throw and error</span><br/><span class="hl-1">        </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-4">approvedAmount</span><span class="hl-1">.</span><span class="hl-7">lt</span><span class="hl-1">(</span><span class="hl-4">deliverOptionParams</span><span class="hl-1">.</span><span class="hl-4">amountToApprove</span><span class="hl-1">)) {</span><br/><span class="hl-1">            </span><span class="hl-5">throw</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-7">Error</span><span class="hl-1">(</span><span class="hl-2">&#39;Approval to option chain failed.&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Step 3: Submit option order request to API.</p>
<p>The <code>tx_hash</code> and <code>execution_price</code> parameters will be populated if the API call is successful. In the case where the API call is unsuccessful, more details are provided by the response from axios, so make sure you use a try-catch block.</p>
<pre><code class="language-javascript"><span class="hl-3">// Submit order to API and get response</span><br/><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> {</span><span class="hl-8">tx_hash</span><span class="hl-1">, </span><span class="hl-8">execution_price</span><span class="hl-1">} = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-4">arrowsdk</span><span class="hl-1">.</span><span class="hl-7">submitOptionOrder</span><span class="hl-1">(</span><span class="hl-4">deliverOptionParams</span><span class="hl-1">, </span><span class="hl-4">version</span><span class="hl-1">)</span><br/><span class="hl-1">} </span><span class="hl-5">catch</span><span class="hl-1">(</span><span class="hl-4">err</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-4">err</span><span class="hl-1">)</span><br/><span class="hl-1">}</span>
</code></pre>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">@arrow-<wbr/>markets/arrow-<wbr/>sdk</a>
<ul>
<li class="tsd-kind-module"><a href="modules/arrow_sdk.html">arrow-<wbr/>sdk</a></li>
<li class="tsd-kind-module"><a href="modules/constants.html">constants</a></li>
<li class="tsd-kind-module"><a href="modules/types.html">types</a></li>
<li class="tsd-kind-module"><a href="modules/utilities.html">utilities</a></li></ul></li></ul></div></details></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>